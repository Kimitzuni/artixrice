#!/bin/bash

MPC="mpc -h 127.0.0.1 -p 6600"
MusicDirectory="$(awk '/^music_directory/ {print $2}' $HOME/.config/mpd/mpd.conf | sed 's/"//g')"

CurrentSong="$($MPC status --format="%artist% - %title%" | head -n1)"
Song="$($MPC status --format="%title%" | head -n1)"
Artist="$($MPC status --format="%artist%" | head -n1)"
Album="$($MPC status --format="%album%" | head -n1)"
Year="$($MPC status --format="%date%" | head -n1 | sed 's/-.*//')"
Artwork="$MusicDirectory/$($MPC status --format="%file%" | head -n1 | awk -F'/' '{print $1 "/" $2 "/cover.jpg"}')"

[ ! -z "$(echo $CurrentSong | grep 'consume:')" ] && CurrentSong="Not Playing"

echo " ðŸ’¿ $CurrentSong "

case $BLOCK_BUTTON in
	"1") [ -z "$(echo "$CurrentSong" | grep 'consume:')" ] && notify-send \
		"$Song" \
		"$Artist\n$Album\n$Year" \
		--icon="$Artwork" \
		--app-name="MPD" \
		--replace-id=102;;
esac
